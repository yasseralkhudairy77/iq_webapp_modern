<!--  --><!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Recruitment Test Suite</title>
<style>
  :root{
    --bg:#f4efe7; --ink:#161616; --muted:#5e5e5e; --line:#d9c9b8; --card:#fff; --accent:#e7853f;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;
    color:var(--ink);
    background:radial-gradient(1100px 500px at 20% -15%,#fff,transparent 65%),linear-gradient(180deg,#faf6ef,var(--bg));
  }
  .wrap{max-width:1200px;margin:0 auto;padding:16px;}
  .head{display:flex;justify-content:space-between;gap:12px;align-items:flex-start;flex-wrap:wrap}
  .title{font-size:22px;font-weight:900}
  .sub{font-size:12px;color:var(--muted);font-weight:700}
  .pill{font-size:12px;border:1px solid var(--line);border-radius:999px;padding:6px 10px;background:#fff}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:14px;box-shadow:0 10px 28px rgba(0,0,0,.05);margin-top:12px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  button,a.btn{
    border:1px solid var(--line);background:#fff;border-radius:10px;padding:8px 10px;
    font-size:12px;font-weight:900;color:var(--ink);text-decoration:none;cursor:pointer;
  }
  button.primary{background:rgba(231,133,63,.16);border-color:rgba(231,133,63,.5)}
  button:disabled{opacity:.5;cursor:not-allowed}
  iframe{width:100%;height:80vh;border:1px solid var(--line);border-radius:14px;background:#fff;margin-top:8px}
</style>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <div>
        <div class="title">Recruitment Test Suite</div>
        <div class="sub">Mulai dari IQ, lalu lanjut ke tes lain tanpa isi identitas ulang.</div>
      </div>
      <div class="pill" id="profileStatus">Profil kandidat: belum terisi</div>
    </div>

    <section class="card">
      <div class="toolbar">
        <div class="pill" id="activeText">Modul aktif: IQ Test</div>
        <button class="primary" data-id="iq">IQ Test</button>
        <button data-id="koran">Tes Pauli/Kraeplin</button>
        <button data-id="typing">Typing Test</button>
        <button data-id="disc">DISC Test</button>
        <button data-id="working">Working Style</button>
        <a id="openNewTab" class="btn" target="_blank" rel="noopener">Buka tab baru</a>
      </div>
      <iframe id="frame" title="Test Module"></iframe>
    </section>
  </div>

<script>
const KEY = "berani_suite_profile_v1";
const TESTS = [
  { id:"iq", name:"IQ Test", path:"apps/iq/index.html", requireProfile:false },
  { id:"koran", name:"Tes Pauli/Kraeplin", path:"apps/koran/index.html", requireProfile:true },
  { id:"typing", name:"Typing Test", path:"apps/typing/index.html", requireProfile:true },
  { id:"disc", name:"DISC Test", path:"apps/disc/index.html", requireProfile:true },
  { id:"working", name:"Working Style", path:"apps/working-style/index.html", requireProfile:true }
];

function readProfile(){
  try{
    const p = JSON.parse(localStorage.getItem(KEY) || "{}");
    return p && typeof p === "object" ? p : {};
  }catch(_){ return {}; }
}
function validProfile(p){ return !!(p.name && p.phone && p.position); }
function esc(v){ return encodeURIComponent((v || "").trim()); }
function buildUrl(test){
  const p = readProfile();
  const q = `name=${esc(p.name)}&phone=${esc(p.phone)}&position=${esc(p.position)}`;
  return `${test.path}?${q}`;
}
function openTest(test){
  const p = readProfile();
  if(test.requireProfile && !validProfile(p)){
    alert("Isi identitas dulu di Tes IQ (nama, WA format 08..., posisi).");
    return;
  }
  const url = buildUrl(test);
  document.getElementById("frame").src = url;
  document.getElementById("openNewTab").href = url;
  document.getElementById("activeText").textContent = `Modul aktif: ${test.name}`;
}
function renderStatus(){
  const p = readProfile();
  document.getElementById("profileStatus").textContent = validProfile(p)
    ? `Profil kandidat: ${p.name} | ${p.phone} | ${p.position}`
    : "Profil kandidat: belum terisi";
}
function refreshButtons(){
  const ok = validProfile(readProfile());
  document.querySelectorAll("button[data-id]").forEach(btn=>{
    const t = TESTS.find(x=>x.id===btn.dataset.id);
    btn.disabled = !!(t && t.requireProfile && !ok);
  });
}

document.addEventListener("click", (e)=>{
  const btn = e.target.closest("button[data-id]");
  if(!btn) return;
  const t = TESTS.find(x=>x.id===btn.dataset.id);
  if(t) openTest(t);
});
window.addEventListener("storage", ()=>{ renderStatus(); refreshButtons(); });

renderStatus();
refreshButtons();
openTest(TESTS[0]);
</script>
</body>
</html>
